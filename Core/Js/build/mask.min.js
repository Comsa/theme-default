var Mask={};(function(){function t(t){e.call(this),this.prototype=Object.create(this),this.$el=t.$el,this.mask=t.mask.trim(),this.errorFunction=t.errorFunction,this.defaultValue=t.defaultValue,this.isUtc=t.isUtc||!1,this.hidePlaceholder=t.hidePlaceholder||!1,this.getBrowser(),this.addExtraChars(),this.setMask()}function e(){this.written={},this.templates={Y:function(t,e,n){var r=(e.length,n.templates.n(t,e,n));return r},M:function(t,e,n){var r=(e.length,n.templates.n(t,e,n));return r},D:function(t,e,n){var r=(e.length,n.templates.n(t,e,n));return r},H:function(t,e,n){var r=(e.length,n.templates.n(t,e,n));return r},m:function(t,e,n){var r=(e.length,n.templates.n(t,e,n));return r},n:function(t,e,n){return parseInt(t)>=0}},this.specialTemplates={n:function(t,e,n){var r=parseInt(t)>=0,a=n.specialModifiers.n;return a?r&&n.finalValue.length<=a:r},az:function(t,e,n){var r=t.match("[ña-zA-Z]")||[],a=n.specialModifiers.az;return a?r&&n.finalValue.length<=a:r.length},"az/n":function(t,e,n){var r=t.match("[ña-zA-Z0-9]")||[],a=n.specialModifiers["az/n"];return a?r&&n.finalValue.length<=a:r.length}},this.validator={Y:function(t,e,n){var r=!0,a=e.getValueFor("D",e.finalValue,e);return a.value&&1==n&&(r=r&&e.validator.D(a.value,e)),r},M:function(t,e,n){var r=parseInt(t),a=r>=1&&12>=r,i=e.getValueFor("D",e.finalValue,e);return i.value&&1==n&&(a=a&&e.validator.D(i.value,e)),a},D:function(t,e){var n=new Date,r=parseInt(t),a=31,i=e.getValueFor("M",e.finalValue,e),o=e.getValueFor("Y",e.finalValue,e);return o.value&&e.validator.Y(o.value,e,!1)&&n.setFullYear(parseInt(o.value)),i.value&&e.validator.M(i.value,e,!1)&&(n.setMonth(parseInt(i.value)),n.setDate(0),a=n.getDate()),r>0&&a>=r?!0:!1},H:function(t){var e=parseInt(t);return e>=0&&24>e},m:function(t){var e=parseInt(t);return e>=0&&60>e},n:function(t){var e=parseInt(t);return e},az:function(t){var e=t.match("[ña-zA-Z]")||!1;return e}},this.browserFunctionalities={keyPress:{ie:function(t){},firefox:function(t){t.avoidKeyPress=!1},chrome:function(t){}},mustAllowKeyDown:{ie:function(t){return!0},firefox:function(t){return!t.avoidKeyPress},chrome:function(t){return!0}},keydown:{ie:function(t){},firefox:function(t){t.avoidKeyPress=!0},chrome:function(t){}}},this.specialModifiers={},this.errors={},this.doNotValidate={},this.tokensBefore=[],this.BACKSPACE=8,this.DELETE=46,this.START=36,this.END=35,this.MOVEMENT=[36,35,37,38,39,40]}this.newMask=function(e){return new t(e)};t.prototype.isIE=function(){var t=window.navigator.userAgent;return t.indexOf("MSIE")>=0||t.indexOf("Trident")>=0},t.prototype.isFirefox=function(){var t=window.navigator.userAgent;return t.indexOf("Firefox")>=0},t.prototype.isChrome=function(){var t=window.navigator.userAgent;return t.indexOf("Chrome")>=0},t.prototype.isSafari=function(){var t=window.navigator.userAgent;return t.indexOf("Safari")>=0},t.prototype.getBrowser=function(){this.isIE()?this.browser="ie":this.isFirefox()?this.browser="firefox":this.isChrome()?this.browser="chrome":this.isSafari()&&(this.browser="chrome")},t.prototype.addExtraChars=function(){function t(){s.templates[r]=function(t,e,n){var r=n.$el.get(0).selectionStart,a=n.mask[r],i=e.charAt(r);return t==a&&t!=i}}function e(){s.validator[r]=function(){return!0}}function n(){s.doNotValidate[r]=!0}for(var r,a,i=0,o=this.mask.length,s=this,u=this.templates[this.mask];o>i&&!u;i++)r=this.mask[i],a=this.templates[r],a||(t(),e(),n())},t.prototype.setMask=function(){var t=this;this.$el.is("input")&&(this.hidePlaceholder||this.$el.attr("placeholder",this.mask),this.specialMask=this.isSpecialMask(this.mask,this),this.defaultValue&&this.setDefaultValue(),this.$el.on("keydown",function(e){function n(){t.browserFunctionalities.keydown[t.browser](t)}function r(){return e.keyCode==t.BACKSPACE}function a(){return e.keyCode==t.DELETE}function i(){return t.MOVEMENT.indexOf(e.keyCode)>=0}function o(){s=l.charAt(f),t.doNotValidate[s]&&(c.selectionStart=p,c.selectionEnd=p,e.preventDefault())}var s,u=$(this),l=u.val(),c=u.get(0),f=c.selectionStart,h=c.selectionEnd,p=f-1,d=!1;r()||a()?(f--,d=!0):i()&&(d=!0),d&&(n(),f==h&&o())}),this.$el.on("keypress",function(e){e.stopImmediatePropagation();var n=t.browserFunctionalities,r=t.browser;n.mustAllowKeyDown[r](t)&&t.keyPressHandler(e,t),n.keyPress[r](t)}))},t.prototype.keyPressHandler=function(t,e,n){function r(){var t=l[f],n=e.mask[f],r=e.getGroupValue(f,l);r.isCompleted&&(!t&&e.doNotValidate[n]?(l+=n,u.val(l),u.get(0).selectionStart++,f++):e.doNotValidate[t]&&(u.get(0).selectionStart++,f++))}function a(){e.finalValue=e.insertCharInCaret(c,l,f)}function i(){o=e.validateValue(e),0==o?e.errors[e.lastInput]=!0:e.errors[e.lastInput]=!1,o=e.checkOldErrors(e),e.errorFunction&&e.errorFunction(o,e.$el)}var o,s=t,e=e,u=$(s.target),l=u.val(),c=String.fromCharCode(s.charCode),f=(u.parent(),u.get(0).selectionStart);e.event=s,a(),this.specialMask||r(),e.completePattern(),e.validPattern&&i(),0!=o&&n&&u.val(e.finalValue),e.advancePosition&&(e.advancePosition=!1,e.$el.get(0).selectionStart=f+1,e.$el.get(0).selectionEnd=f+1,e.finalValue=l)},t.prototype.isSpecialMask=function(t,e){var n,r,a,t=e.mask;return $.each(e.specialTemplates,function(e,i){t.indexOf(e)>=0&&(n=i,r=e,a=parseInt(t.substring(e.length)))}),a&&(e.specialModifiers[r]=a,e.maskNoModifiers=r),n},t.prototype.UTCDateFunction={"true":{Y:"getUTCFullYear",M:"getUTCMonth",D:"getUTCDate",H:"getUTCHours",m:"getUTCMinutes",s:"getUTCSeconds"},"false":{Y:"getFullYear",M:"getMonth",D:"getDate",H:"getHours",m:"getMinutes",s:"getSeconds"}},t.prototype.createDefaultValue={Y:function(t,e){var n=new Date(t.defaultValue),r=(t.isUtc,t.UTCDateFunction[t.isUtc].Y);return n[r]()},M:function(t,e){var n=new Date(t.defaultValue),r=(t.isUtc,t.UTCDateFunction[t.isUtc].M);return n[r]()+1},D:function(t,e){var n=new Date(t.defaultValue),r=(t.isUtc,t.UTCDateFunction[t.isUtc].D);return n[r]()},H:function(t,e){var n=new Date(t.defaultValue),r=(t.isUtc,t.UTCDateFunction[t.isUtc].H);return n[r]()},m:function(t,e){var n=new Date(t.defaultValue),r=(t.isUtc,t.UTCDateFunction[t.isUtc].m);return n[r]()},s:function(t,e){var n=new Date(t.defaultValue),r=t.UTCDateFunction[t.isUtc].s;return n[r]()}},t.prototype.setDefaultValue=function(){function t(){c=Object.keys(f.specialModifiers)[0]}function e(){c&&(l=f.validator[c])}function n(){var t=f.specialModifiers[c];h.length>t&&(k=h.substr(0,t))}function r(){(!l||l(k))&&(p=k)}function a(){for(;m>v;v++)V={"char":"",occurrences:0},s=g[v],V["char"]=s,f.doNotValidate[s]?(V.occurrences=1,d.push(V)):C[s]||(C[s]=!0,u=f.getNumberOf(s),V.occurrences=u,d.push(V))}function i(){for(var t,e,n=0,r=d.length,a="";r>n;n++)t=d[n],e=f.createDefaultValue[t["char"]],a=e?e(f,t.occurrences):t["char"],a=o(a.toString(),t.occurrences),p+=a}function o(t,e){var n,r=t.length,a=t;return r>e?(n=r-e,a=t.substr(n,r)):e>r&&(diff=e-r,a=o("0"+a,e)),a}var s,u,l,c,f=this,h=(this.$el,this.defaultValue),p="",d=[],v=0,g=this.mask,m=g.length,k=h,V={"char":"",occurrences:0},C={};this.isSpecialMask(g,f)?(t(),e(),n(),r()):(a(),i()),f.$el.val(p)},t.prototype.insertCharInCaret=function(t,e,n){var r=e.substring(0,n),a=e.substring(n);return r+t+a},t.prototype.completePattern=function(){function t(){return"undefined"!=typeof m||k}function e(){l=p.getGroupValue(g),c=p.mask.indexOf(l.group)+l.groupCount,m=l.value.length>l.groupCount?p.lastInput=p.mask[c]:p.lastInput=l.group}function n(){u=k||p.templates[m]}function r(){u?p.validPattern=u(v,h,p):p.validPattern=!1}function a(){p.doNotValidate[m]&&(p.advancePosition=!0)}function i(){0==p.validPattern&&(o(),p.advancePosition=!0)}function o(){V=!0}function s(){V&&f.preventDefault()}var u,l,c,f=this.event,h=this.value=$(f.target).val(),p=this,d=this.mask,v=String.fromCharCode(f.charCode),g=this.$el.get(0).selectionStart,m=d[g],k=this.specialMask,V=!1;this.getTokensBefore(g),t()?(e(),n(),r(),a(),i()):o(),s()},t.prototype.validateValue=function(t,e){var n,r=e||t.lastInput,a=t.doNotValidate[r],i=t.getValueFor(r,t.finalValue,t);return a||i.patternCount!=i.inputCount||(n=t.validator[r],a=n(i.value,t,!0),t.autoCompleteWithToken(t)),a},t.prototype.autoCompleteWithToken=function(t){var e=t.$el.get(0).selectionStart+1,n=t.mask[e],r=t.finalValue[e],a=t.specialModifiers||{},i=a[t.maskNoModifiers];if(t.doNotValidate[n]&&n!=r&&i!=n){var o=t.insertCharInCaret(n,t.finalValue,e);t.$el.val(o),t.event.preventDefault()}},t.prototype.checkOldErrors=function(t){var e;return $.each(t.errors,function(n,r){1==r&&0!=e&&(e=t.validateValue(t,n))}),e},t.prototype.getGroupValue=function(t,e){this.getTokensBefore(t);var n=this.getPositionInMask(),r=this.getNumberOf(n),a=this.getInputGroupBounds(e);-1==a.start&&(a.start=0),-1==a.end&&(a.end=t+r);var i=this.finalValue.substring(a.start,a.end);return{value:i,group:n,groupCount:r,isCompleted:r==i.length}},t.prototype.getInputGroupBounds=function(t){for(var e,n=t||this.finalValue,r=0,a=n.length,i=0,o=-1,s=-1,u={start:-1,end:-1};a>r;r++)e=n[r],this.doNotValidate[e]&&e==this.tokensBefore[i]&&(o=r+1,i++);for(0>o&&(o=0),u.start=o;a>o;o++)e=n[o],this.doNotValidate[e]&&(s=o,o=a);return 0>s&&(s=a),u.end=s,u},t.prototype.getNumberOf=function(t){for(var e=this.mask,n=0,r=e.length,a=0;r>n;n++)t==e[n]&&a++;return a},t.prototype.getTokensBefore=function(t){this.tokensBefore=[];var e,n=0;for(this.distanceFromToken=0;t>n;n++)e=this.finalValue[n],this.distanceFromToken++,this.doNotValidate[e]&&(this.distanceFromToken=1,this.tokensBefore.push(e))},t.prototype.getPositionInMask=function(){for(var t,e,n,r=this.tokensBefore,a=r.length,i=0,o=0,s=this.mask,u=s.length,l="";a>i;i++)for(e=o,t=r[i];u>e;e++)n=s[e],this.doNotValidate[n]&&t==n&&(l=s[e+1],o=e+1,e=u);return 0==i&&(l=s[0]),l},t.prototype.getValueFor=function(t,e,n){for(var r,a=n.mask,i=a.indexOf(t),o=a.lastIndexOf(t),s="",u={},l=0,c=0;o>=i;i++)l++,a.charAt(i)==t?(r=e[i]||"",n.templates[t](r,e,n)?(s+=r,c++):i=o+1):(s="",i=o+1);return u.value=s,u.patternCount=l,u.inputCount=c,u}}).apply(Mask);